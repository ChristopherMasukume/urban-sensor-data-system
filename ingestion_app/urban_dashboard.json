{
  "id": null,
  "title": "Urban Environmental Monitoring",
  "tags": ["environment", "IoT", "sensors"],
  "timezone": "browser",
  "schemaVersion": 36,
  "version": 2,
  "refresh": "10s",
  "panels": [
    {
      "type": "timeseries",
      "title": "Temperature Readings (T1â€“T9)",
      "datasource": {
        "type": "postgres",
        "uid": "your_postgres_datasource"
      },
      "targets": [
        {
          "format": "time_series",
          "rawSql": "SELECT time AS \"time\", metric_value AS \"Temperature\" FROM sensor_readings WHERE metric_name LIKE 'T%' ORDER BY time;",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "celsius",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "orange", "value": 30 },
              { "color": "red", "value": 40 }
            ]
          }
        }
      },
      "alert": {
        "name": "High Temperature Alert",
        "condition": "C",
        "for": "5m",
        "frequency": "1m",
        "noDataState": "no_data",
        "executionErrorState": "alerting",
        "conditions": [
          {
            "type": "query",
            "evaluator": { "type": "gt", "params": [40] },
            "operator": { "type": "and" },
            "query": { "params": ["A", "5m", "now"] },
            "reducer": { "type": "avg", "params": [] }
          }
        ]
      }
    },
    {
      "type": "timeseries",
      "title": "CO2 Levels",
      "datasource": {
        "type": "postgres",
        "uid": "your_postgres_datasource"
      },
      "targets": [
        {
          "format": "time_series",
          "rawSql": "SELECT time AS \"time\", metric_value AS \"CO2 (ppm)\" FROM sensor_readings WHERE metric_name = 'co2' ORDER BY time;",
          "refId": "B"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ppm",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "orange", "value": 800 },
              { "color": "red", "value": 1000 }
            ]
          }
        }
      },
      "alert": {
        "name": "High CO2 Alert",
        "condition": "C",
        "for": "5m",
        "frequency": "1m",
        "noDataState": "no_data",
        "executionErrorState": "alerting",
        "conditions": [
          {
            "type": "query",
            "evaluator": { "type": "gt", "params": [1000] },
            "operator": { "type": "and" },
            "query": { "params": ["B", "5m", "now"] },
            "reducer": { "type": "avg", "params": [] }
          }
        ]
      }
    },
    {
      "type": "timeseries",
      "title": "Humidity",
      "datasource": {
        "type": "postgres",
        "uid": "your_postgres_datasource"
      },
      "targets": [
        {
          "format": "time_series",
          "rawSql": "SELECT time AS \"time\", metric_value AS \"Humidity (%)\" FROM sensor_readings WHERE metric_name = 'humidity' ORDER BY time;",
          "refId": "C"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "red", "value": null },
              { "color": "orange", "value": 30 },
              { "color": "green", "value": 50 }
            ]
          }
        }
      },
      "alert": {
        "name": "Low Humidity Alert",
        "condition": "C",
        "for": "10m",
        "frequency": "2m",
        "noDataState": "no_data",
        "executionErrorState": "alerting",
        "conditions": [
          {
            "type": "query",
            "evaluator": { "type": "lt", "params": [30] },
            "operator": { "type": "and" },
            "query": { "params": ["C", "10m", "now"] },
            "reducer": { "type": "avg", "params": [] }
          }
        ]
      }
    },
    {
      "type": "gauge",
      "title": "Latest Wind Speed",
      "datasource": {
        "type": "postgres",
        "uid": "your_postgres_datasource"
      },
      "targets": [
        {
          "format": "table",
          "rawSql": "SELECT metric_value FROM sensor_readings WHERE metric_name = 'windspeed' ORDER BY time DESC LIMIT 1;",
          "refId": "D"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "m/s",
          "min": 0,
          "max": 100,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "orange", "value": 20 },
              { "color": "red", "value": 40 }
            ]
          }
        }
      },
      "alert": {
        "name": "High Wind Speed Alert",
        "condition": "C",
        "for": "2m",
        "frequency": "1m",
        "noDataState": "no_data",
        "executionErrorState": "alerting",
        "conditions": [
          {
            "type": "query",
            "evaluator": { "type": "gt", "params": [40] },
            "operator": { "type": "and" },
            "query": { "params": ["D", "2m", "now"] },
            "reducer": { "type": "avg", "params": [] }
          }
        ]
      }
    }
  ],
  "templating": {
    "list": []
  }
}
